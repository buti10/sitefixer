import{d as j,i as B,m as C,k as M,j as T,o as V,p as S,c as l,a as s,t as a,e as i,F as D,r as F,l as N,v as I,q as K,s as m,x as b,n as u,b as z,h as c}from"./index-CEe5TGL3.js";const A={class:"flex items-center justify-between"},E={class:"text-sm font-semibold"},L={class:"text-xs opacity-70"},P={id:"chat-scroll",class:"h-[62vh] rounded-xl border bg-white dark:bg-[#0f1424] overflow-y-auto p-3"},U={class:"max-w-[70%]"},q={key:0},H=["onKeydown"],J=j({__name:"ChatDetail",setup(R){const y=C(),n=B(),o=Number(y.params.id),v=M(()=>n.msgs(o)),d=T("");function _(e){return e?new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}function w(e){return n.ticksFor(o,e)}function h(){const e=document.getElementById("chat-scroll");e&&(e.scrollTop=e.scrollHeight)}async function k(){await n.loadMessages(o),b(h),n.startThreadPolling(o,2e3)}V(k),S(()=>n.stopThreadPolling(o));function p(){const e=d.value.trim();e&&n.sendMessage(o,e).then(()=>{d.value="",b(h)})}function f(){n.markVisible(o)}return(e,r)=>{var g,x;return c(),l("div",{class:"space-y-3",onMouseenter:f,onFocusin:f},[s("div",A,[s("h2",E,"Chat #"+a(i(o)),1),s("div",L,a(((g=i(n).byId(i(o)))==null?void 0:g.visitor)||"Visitor")+" • "+a(((x=i(n).byId(i(o)))==null?void 0:x.page)||"—"),1)]),s("div",P,[(c(!0),l(D,null,F(v.value,t=>(c(),l("div",{key:t.id,class:u(["mb-2 flex",t.author==="agent"?"justify-end":"justify-start"])},[s("div",U,[s("div",{class:u([t.author==="agent"?"bg-blue-600 text-white":"bg-gray-100 dark:bg-white/10 text-gray-900 dark:text-gray-100","rounded-2xl px-3 py-2 text-sm"])},a(t.text),3),s("div",{class:u(["mt-0.5 text-[11px] opacity-70 flex items-center gap-1",t.author==="agent"?"justify-end":"justify-start"])},[s("span",null,a(_(t.sentAt||t.deliveredAt)),1),t.author==="agent"?(c(),l("span",q,a(w(t.id)),1)):z("",!0)],2)])],2))),128))]),s("form",{class:"rounded-xl border bg-white dark:bg-[#0f1424] p-2 flex gap-2",onSubmit:m(p,["prevent"])},[N(s("textarea",{"onUpdate:modelValue":r[0]||(r[0]=t=>d.value=t),rows:"1",class:"flex-1 rounded border px-3 py-2 bg-transparent resize-none text-sm",placeholder:"Nachricht…",onKeydown:K(m(p,["exact","prevent"]),["enter"])},null,40,H),[[I,d.value]]),r[1]||(r[1]=s("button",{class:"rounded bg-blue-600 text-white px-3 py-2 hover:bg-blue-700"},"Senden",-1))],32)],32)}}});export{J as default};

import{d as C,j as g,y as M,k as j,o as V,c as r,a as e,l as b,v as x,f as d,z as h,w as y,b as B,F as k,r as w,t as v,A as F,h as i}from"./index-CEe5TGL3.js";const K={class:"space-y-4"},N={class:"flex items-center justify-between"},T={class:"flex gap-2 text-sm"},U={class:"grid sm:grid-cols-2 lg:grid-cols-4 gap-3"},$={class:"grid lg:grid-cols-2 gap-4"},D={class:"w-full text-sm"},E={class:"p-2 truncate"},L={class:"p-2"},R={class:"p-2"},z={key:0},q={class:"grid grid-cols-12 gap-1 text-center text-xs"},H=["title"],O={components:{Kpi:{props:{label:String,value:[String,Number]},template:'<div class="border rounded-xl p-4"><div class="text-xs opacity-60">{{label}}</div><div class="text-2xl">{{value}}</div></div>'},Card:{props:{title:String},template:'<div class="rounded-xl border overflow-hidden"><div class="p-3 font-medium border-b">{{title}}</div><div class="p-3"><slot/></div></div>'}}},I=C({...O,__name:"StatsMail",setup(P){const c=g(""),u=g(""),l=M({unread:0,received:0,replied:0,avg_frt_sec:0,top_senders:[],by_hour:Array(24).fill(0)}),S=j(()=>Math.max(1,...l.by_hour));function p(s){return typeof s=="number"?s.toLocaleString():"—"}function _(s){if(!s)return"—";const t=Math.floor(s/60),n=s%60;return`${t}m ${n}s`}async function m(){const s=new URLSearchParams;c.value&&s.set("from",c.value),u.value&&s.set("to",u.value);const t=await fetch(`/mock/stats/mail.json?${s.toString()}`);Object.assign(l,await t.json())}return V(m),(s,t)=>{const n=h("Kpi"),f=h("Card");return i(),r("div",K,[e("div",N,[t[2]||(t[2]=e("h1",{class:"text-xl font-semibold"},"Mail Stats",-1)),e("div",T,[b(e("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=a=>c.value=a),class:"border rounded px-2 py-1"},null,512),[[x,c.value]]),b(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=a=>u.value=a),class:"border rounded px-2 py-1"},null,512),[[x,u.value]]),e("button",{class:"px-3 py-1.5 border rounded",onClick:m},"Aktualisieren")])]),e("div",U,[d(n,{label:"Ungelesen",value:p(l.unread)},null,8,["value"]),d(n,{label:"Eingänge",value:p(l.received)},null,8,["value"]),d(n,{label:"Beantwortet",value:p(l.replied)},null,8,["value"]),d(n,{label:"Avg. First Response",value:_(l.avg_frt_sec)},null,8,["value"])]),e("div",$,[d(f,{title:"Top Absender"},{default:y(()=>{var a;return[e("table",D,[t[4]||(t[4]=e("thead",{class:"bg-black/5 dark:bg-white/5"},[e("tr",null,[e("th",{class:"p-2 text-left"},"Absender"),e("th",{class:"p-2 text-left"},"E-Mails"),e("th",{class:"p-2 text-left"},"Avg. FRT")])],-1)),e("tbody",null,[(i(!0),r(k,null,w(l.top_senders,(o,A)=>(i(),r("tr",{key:A,class:"border-t"},[e("td",E,v(o.from),1),e("td",L,v(p(o.count)),1),e("td",R,v(_(o.avg_frt_sec)),1)]))),128)),(a=l.top_senders)!=null&&a.length?B("",!0):(i(),r("tr",z,[...t[3]||(t[3]=[e("td",{class:"p-4 text-center opacity-60",colspan:"3"},"Keine Daten",-1)])]))])])]}),_:1}),d(f,{title:"Aktivität nach Stunde"},{default:y(()=>[e("div",q,[(i(!0),r(k,null,w(l.by_hour,(a,o)=>(i(),r("div",{key:o,class:"h-8 rounded",title:o+":00 → "+a,style:F({background:`rgba(59,130,246,${a/S.value||0})`})},v(o),13,H))),128))])]),_:1})])])}}});export{I as default};
